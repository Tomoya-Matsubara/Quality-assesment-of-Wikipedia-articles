<p>In <a href="cryptography" class="uri" title="wikilink">cryptography</a>, a <strong>ring signature</strong> is a type of <a href="digital_signature" title="wikilink">digital signature</a> that can be performed by any member of a group of users that each have <a href="key_(cryptography)" title="wikilink">keys</a>. Therefore, a message signed with a ring signature is endorsed by someone in a particular group of people. One of the security properties of a ring signature is that it should be difficult to determine <em>which</em> of the group members' keys was used to produce the signature. Ring signatures are similar to <a href="group_signature" title="wikilink">group signatures</a> but differ in two key ways: first, there is no way to revoke the anonymity of an individual signature, and second, any group of users can be used as a group without additional setup. Ring signatures were invented by <a href="Ron_Rivest" title="wikilink">Ron Rivest</a>, <a href="Adi_Shamir" title="wikilink">Adi Shamir</a>, and <a href="Yael_Tauman" title="wikilink">Yael Tauman</a>, and introduced at <a href="ASIACRYPT" class="uri" title="wikilink">ASIACRYPT</a> in 2001.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> The name &quot;ring signature&quot; comes from the ring-like structure of the signature <a href="algorithm" class="uri" title="wikilink">algorithm</a>.</p>
<h2 id="definition">Definition</h2>
<p>Suppose that a group of entities each have public/private key pairs, (<em>PK</em><sub>1</sub>, <em>SK</em><sub>1</sub>), (<em>PK</em><sub>2</sub>, <em>SK</em><sub>2</sub>), ... ,(<em>PK</em><sub><em>n</em></sub>, <em>SK</em><sub><em>n</em></sub>). Party <em>i</em> can compute a ring signature &lt;U+03C3&gt; on a message <em>m</em>, on input (<em>m</em>, <em>SK</em><sub><em>i</em></sub>, <em>PK</em><sub>1</sub>, ... , <em>PK</em><sub><em>n</em></sub>). Anyone can check the validity of a ring signature given &lt;U+03C3&gt;, <em>m</em>, and the public keys involved, <em>PK</em><sub>1</sub>, ... , <em>PK</em><sub><em>n</em></sub>. If a ring signature is properly computed, it should pass the check. On the other hand, it should be hard for anyone to create a valid ring signature on any message for any group without knowing any of the secret keys for that group.</p>
<h2 id="applications">Applications</h2>
<p>In the original paper, Rivest, Shamir, and Tauman described ring signatures as a way to leak a secret. For instance, a ring signature could be used to provide an anonymous signature from &quot;a high-ranking <a href="White_House" title="wikilink">White House</a> official&quot;, without revealing which official signed the message. Ring signatures are right for this application because the anonymity of a ring signature cannot be revoked, and because the group for a ring signature can be improvised.</p>
<p>Another application, also described in the original paper, is for <a href="deniable_signature" title="wikilink">deniable signatures</a>. A ring signature where the group is the sender and the recipient of a message will only seem to be a signature of the sender to the recipient: anyone else will be unsure whether the recipient or the sender was the actual signer. Thus, such a signature is convincing, but cannot be transferred beyond its intended recipient.</p>
<h2 id="implementation">Implementation</h2>
<p>Here a <a href="Python_(language)" title="wikilink">Python</a> implementation of the original paper using <a href="Rivest_Shamir_Adleman" title="wikilink">RSA</a>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="im">import</span> os,hashlib,random,Crypto.PublicKey.RSA</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw">class</span> ring:</a>
<a class="sourceLine" id="cb1-4" data-line-number="4">    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>,k,l<span class="op">=</span><span class="dv">1024</span>):</a>
<a class="sourceLine" id="cb1-5" data-line-number="5">        <span class="va">self</span>.k <span class="op">=</span> k</a>
<a class="sourceLine" id="cb1-6" data-line-number="6">        <span class="va">self</span>.l,<span class="va">self</span>.n,<span class="va">self</span>.q <span class="op">=</span> l,<span class="bu">len</span>(k),<span class="dv">1</span><span class="op">&lt;&lt;</span>l<span class="dv">-1</span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7"></a>
<a class="sourceLine" id="cb1-8" data-line-number="8">    <span class="kw">def</span> sign(<span class="va">self</span>,m,z):</a>
<a class="sourceLine" id="cb1-9" data-line-number="9">        <span class="va">self</span>.permut(m)</a>
<a class="sourceLine" id="cb1-10" data-line-number="10">        s,u <span class="op">=</span> [<span class="va">None</span>]<span class="op">*</span><span class="va">self</span>.n,random.randint(<span class="dv">0</span>,<span class="va">self</span>.q)</a>
<a class="sourceLine" id="cb1-11" data-line-number="11">        c <span class="op">=</span> v <span class="op">=</span> <span class="va">self</span>.E(u) </a>
<a class="sourceLine" id="cb1-12" data-line-number="12">        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(z<span class="op">+</span><span class="dv">1</span>,<span class="va">self</span>.n)<span class="op">+</span><span class="bu">range</span>(z):</a>
<a class="sourceLine" id="cb1-13" data-line-number="13">            s[i] <span class="op">=</span> random.randint(<span class="dv">0</span>,<span class="va">self</span>.q)</a>
<a class="sourceLine" id="cb1-14" data-line-number="14">            v <span class="op">=</span> <span class="va">self</span>.E(v<span class="op">^</span><span class="va">self</span>.g(s[i],<span class="va">self</span>.k[i].e,<span class="va">self</span>.k[i].n)) </a>
<a class="sourceLine" id="cb1-15" data-line-number="15">            <span class="cf">if</span> (i<span class="op">+</span><span class="dv">1</span>)<span class="op">%</span><span class="va">self</span>.n <span class="op">==</span> <span class="dv">0</span>: c <span class="op">=</span> v</a>
<a class="sourceLine" id="cb1-16" data-line-number="16">        s[z] <span class="op">=</span> <span class="va">self</span>.g(v<span class="op">^</span>u,<span class="va">self</span>.k[z].d,<span class="va">self</span>.k[z].n)</a>
<a class="sourceLine" id="cb1-17" data-line-number="17">        <span class="cf">return</span> [c,] <span class="op">+</span> s</a>
<a class="sourceLine" id="cb1-18" data-line-number="18"></a>
<a class="sourceLine" id="cb1-19" data-line-number="19">    <span class="kw">def</span> verify(<span class="va">self</span>,m,X):</a>
<a class="sourceLine" id="cb1-20" data-line-number="20">        <span class="va">self</span>.permut(m)</a>
<a class="sourceLine" id="cb1-21" data-line-number="21">        y <span class="op">=</span> <span class="bu">map</span>(<span class="kw">lambda</span> i:<span class="va">self</span>.g(X[i<span class="op">+</span><span class="dv">1</span>],<span class="va">self</span>.k[i].e,<span class="va">self</span>.k[i].n),<span class="bu">range</span>(<span class="bu">len</span>(X)<span class="op">-</span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb1-22" data-line-number="22">        <span class="cf">return</span> <span class="bu">reduce</span>(<span class="kw">lambda</span> x,i:<span class="va">self</span>.E(x<span class="op">^</span>y[i]),<span class="bu">range</span>(<span class="va">self</span>.n),X[<span class="dv">0</span>]) <span class="op">==</span> X[<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb1-23" data-line-number="23"></a>
<a class="sourceLine" id="cb1-24" data-line-number="24">    <span class="kw">def</span> permut(<span class="va">self</span>,m):</a>
<a class="sourceLine" id="cb1-25" data-line-number="25">        <span class="va">self</span>.p <span class="op">=</span> <span class="bu">int</span>(hashlib.sha1(<span class="st">&#39;</span><span class="sc">%s</span><span class="st">&#39;</span><span class="op">%</span>m).hexdigest(),<span class="dv">16</span>)</a>
<a class="sourceLine" id="cb1-26" data-line-number="26"></a>
<a class="sourceLine" id="cb1-27" data-line-number="27">    <span class="kw">def</span> E(<span class="va">self</span>,x): </a>
<a class="sourceLine" id="cb1-28" data-line-number="28">        <span class="cf">return</span> <span class="bu">int</span>(hashlib.sha1(<span class="st">&#39;</span><span class="sc">%s%s</span><span class="st">&#39;</span><span class="op">%</span>(x,<span class="va">self</span>.p)).hexdigest(),<span class="dv">16</span>)</a>
<a class="sourceLine" id="cb1-29" data-line-number="29"></a>
<a class="sourceLine" id="cb1-30" data-line-number="30">    <span class="kw">def</span> g(<span class="va">self</span>,x,e,n):</a>
<a class="sourceLine" id="cb1-31" data-line-number="31">        q,r <span class="op">=</span> x<span class="op">//</span>n,x<span class="op">%</span>n</a>
<a class="sourceLine" id="cb1-32" data-line-number="32">        <span class="cf">return</span> q<span class="op">*</span>n <span class="op">+</span> <span class="bu">pow</span>(r,e,n) <span class="cf">if</span> (q<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>n <span class="op">&lt;=</span> (<span class="dv">1</span><span class="op">&lt;&lt;</span><span class="va">self</span>.l)<span class="op">-</span><span class="dv">1</span> <span class="cf">else</span> x</a></code></pre></div>
<p>Sign and verify two messages in a four users ring:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb2-1" data-line-number="1">size,msg1,msg2 <span class="op">=</span> <span class="dv">4</span>,<span class="st">&#39;hello&#39;</span>,<span class="st">&#39;world!&#39;</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2">r <span class="op">=</span> ring(<span class="bu">map</span>(<span class="kw">lambda</span> _:Crypto.PublicKey.RSA.generate(<span class="dv">1024</span>, os.urandom),<span class="bu">range</span>(size)))</a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(size):</a>
<a class="sourceLine" id="cb2-4" data-line-number="4">    s1,s2 <span class="op">=</span> r.sign(msg1,i),r.sign(msg2,i)</a>
<a class="sourceLine" id="cb2-5" data-line-number="5">    <span class="cf">assert</span> r.verify(msg1,s1) <span class="kw">and</span> r.verify(msg2,s2) <span class="kw">and</span> <span class="kw">not</span> r.verify(msg1,s2)</a></code></pre></div>
<h2 id="references">References</h2>
<references />
<p><a href="Category:Cryptography" class="uri" title="wikilink">Category:Cryptography</a></p>
<section class="footnotes">
<hr />
<ol>
<li id="fn1"><a href="http://www.springerlink.com/content/kxkndv9rgk8lu3h9/"><em>How to leak a secret</em></a>, <a href="Ron_Rivest" title="wikilink">Ron Rivest</a>, <a href="Adi_Shamir" title="wikilink">Adi Shamir</a>, and <a href="Yael_Tauman" title="wikilink">Yael Tauman</a>, ASIACRYPT 2001.<a href="#fnref1" class="footnote-back">↩</a></li>
</ol>
</section>
