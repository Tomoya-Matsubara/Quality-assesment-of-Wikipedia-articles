
<p><strong>DNS hijacking</strong> or <strong>DNS redirection</strong> is the practice of subverting the resolution of <a href="Domain_Name_System" title="wikilink">Domain Name System</a> (DNS) queries. This can be achieved by malware that overrides a computer's <a href="Internet_protocol_suite" title="wikilink">TCP/IP</a> configuration to point at a rogue DNS server under the control of an attacker, or through modifying the behaviour of a trusted DNS server so that it does not comply with internet standards.</p>
<p>These modifications may be made for malicious purposes such as <a href="phishing" class="uri" title="wikilink">phishing</a>, or for self-serving purposes by <a href="Internet_service_providers" title="wikilink">Internet service providers</a> (ISPs) to direct users' web traffic to the ISP's own <a href="web_server" title="wikilink">web servers</a> where advertisements can be served, statistics collected, or other purposes of the ISP; and by DNS service providers to block access to selected domains as a form of <a href="Internet_censorship#Technical_censorship" title="wikilink">censorship</a>.</p>
<h2 id="technical-background">Technical background</h2>
<p>One of the functions of a DNS server is to translate a <a href="domain_name" title="wikilink">domain name</a> into an <a href="IP_address" title="wikilink">IP address</a> that <a href="Application_software" title="wikilink">applications</a> need to connect to an Internet resource such as a <a href="website" class="uri" title="wikilink">website</a>. This functionality is defined in various formal <a href="internet_standard" title="wikilink">internet standards</a> that define the <a href="Communications_protocol" title="wikilink">protocol</a> in considerable detail. DNS servers are implicitly trusted by internet-facing computers and users to correctly resolve names to the actual addresses that are registered by the owners of an internet domain.</p>
<h3 id="rogue-dns-server">Rogue DNS server</h3>
<p>A rogue DNS server translates domain names of desirable websites (search engines, banks, brokers, etc.) into IP addresses of sites with unintended content, even malicious websites. Most users depend on DNS servers automatically assigned by their <a href="ISP" title="wikilink">ISPs</a>. <a href="Zombie_computer" title="wikilink">Zombie computers</a> use DNS-changing <a href="Trojan_horse_(computing)" title="wikilink">trojans</a> to invisibly switch the automatic DNS server assignment by the ISP to manual DNS server assignment from rogue DNS servers. When users try to visit websites, they are instead sent to a bogus website. This attack is termed <a href="pharming" class="uri" title="wikilink">pharming</a>. If the site they are redirected to is a malicious website, masquerading as a legitimate website, in order to fraudulently obtain sensitive information, it is termed <a href="phishing" class="uri" title="wikilink">phishing</a>.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></p>
<h3 id="manipulation-by-isps">Manipulation by ISPs</h3>
<p>A number of consumer ISPs such as <a href="Cablevision" class="uri" title="wikilink">Cablevision</a>'s <a href="Optimum_Online" title="wikilink">Optimum Online</a>,<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a> <a href="Comcast" class="uri" title="wikilink">Comcast</a>,<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a> <a href="Time_Warner" title="wikilink">Time Warner</a>, <a href="Cox_Communications" title="wikilink">Cox Communications</a>, <a href="RCN_Corporation" title="wikilink">RCN</a>,<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a> Rogers,<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a> <a href="Charter_Communications" title="wikilink">Charter Communications</a>, <a href="Verizon" class="uri" title="wikilink">Verizon</a>, <a href="Virgin_Media" title="wikilink">Virgin Media</a>,<a href="#fn6" class="footnote-ref" id="fnref6"><sup>6</sup></a><a href="#fn7" class="footnote-ref" id="fnref7"><sup>7</sup></a> <a href="Frontier_Communications" title="wikilink">Frontier Communications</a>, <a href="Bell_Sympatico" title="wikilink">Bell Sympatico</a>,<a href="#fn8" class="footnote-ref" id="fnref8"><sup>8</sup></a> <a href="UPC_Broadband" title="wikilink">UPC</a>,<a href="#fn9" class="footnote-ref" id="fnref9"><sup>9</sup></a> <a href="T-Online" class="uri" title="wikilink">T-Online</a>,<a href="#fn10" class="footnote-ref" id="fnref10"><sup>10</sup></a> <a href="Optus" class="uri" title="wikilink">Optus</a>,<a href="#fn11" class="footnote-ref" id="fnref11"><sup>11</sup></a> <a href="Mediacom" class="uri" title="wikilink">Mediacom</a>,<a href="#fn12" class="footnote-ref" id="fnref12"><sup>12</sup></a> <a href="ONO_(Spain)" title="wikilink">ONO</a>,<a href="#fn13" class="footnote-ref" id="fnref13"><sup>13</sup></a> <a href="TalkTalk" class="uri" title="wikilink">TalkTalk</a><a href="#fn14" class="footnote-ref" id="fnref14"><sup>14</sup></a> and <a href="Bigpond" class="uri" title="wikilink">Bigpond</a> (<a href="Telstra" class="uri" title="wikilink">Telstra</a>)<a href="#fn15" class="footnote-ref" id="fnref15"><sup>15</sup></a><a href="#fn16" class="footnote-ref" id="fnref16"><sup>16</sup></a><a href="#fn17" class="footnote-ref" id="fnref17"><sup>17</sup></a><a href="#fn18" class="footnote-ref" id="fnref18"><sup>18</sup></a> use DNS hijacking for their own purposes, such as displaying advertisements<a href="#fn19" class="footnote-ref" id="fnref19"><sup>19</sup></a> or collecting statistics. This practice violates the <a href="Request_for_Comments" title="wikilink">RFC</a> standard for DNS (NXDOMAIN) responses,<a href="#fn20" class="footnote-ref" id="fnref20"><sup>20</sup></a> and can potentially open users to <a href="cross-site_scripting" title="wikilink">cross-site scripting</a> attacks.<a href="#fn21" class="footnote-ref" id="fnref21"><sup>21</sup></a></p>
<p>The concern with DNS hijacking involves this hijacking of the NXDOMAIN response. Internet and <a href="intranet" class="uri" title="wikilink">intranet</a> applications rely on the NXDOMAIN response to describe the condition where the DNS has no entry for the specified host. If one were to query the invalid domain name (fakeexample.com), one should get an NXDOMAIN response - informing the application that the name is invalid and taking the appropriate action (for example, displaying an error or not attempting to connect to the server). However, if the domain name is queried on one of these non-compliant ISPs, one would always receive a fake IP address belonging to the ISP. In a <a href="web_browser" title="wikilink">web browser</a>, this behavior can be annoying or offensive as connections to this IP address display the <a href="ISP_redirect_page" title="wikilink">ISP redirect page</a> of the provider, sometimes with advertising, instead of a proper error message. However, other applications that rely on the NXDOMAIN error will instead attempt to initiate connections to this spoofed IP address, potentially exposing sensitive information.</p>
<p>Examples of functionality that breaks when an ISP hijacks DNS:</p>
<ul>
<li>Roaming laptops that are members of a <a href="Windows_Server_domain" title="wikilink">Windows Server domain</a> will falsely be led to believe that they are back on a corporate network because resources such as <a href="domain_controller" title="wikilink">domain controllers</a>, <a href="Message_transfer_agent" title="wikilink">email servers</a> and other infrastructure will appear to be available. Applications will therefore attempt to initiate connections to these corporate servers, but fail, resulting in degraded performance, unnecessary <a href="Internet_traffic" title="wikilink">traffic on the internet connection</a> and <a href="Timeout_(computing)" title="wikilink">timeouts</a>.</li>
<li>Many small office and home networks do not have their own DNS server, relying instead on <a href="Broadcasting_(computing)" title="wikilink">broadcast</a> name resolution. Many versions of Microsoft Windows default to prioritizing DNS name resolution above NetBIOS name resolution broadcasts; therefore, when an ISP DNS server returns a (technically valid) IP address for the name of the desired computer on the LAN, the connecting computer uses this incorrect IP address and inevitably fails to connect to the desired computer on the LAN. Workarounds include using the correct IP address instead of the computer name, or <a href="http://www.howtonetworking.com/netbios&amp;wins.htm#How%20to%20modify%20Node%20Type%7Cchanging">the DhcpNodeType registry value</a> to change name resolution service ordering.</li>
<li>Browsers such as <a href="Firefox" class="uri" title="wikilink">Firefox</a> no longer have their 'Browse By Name' functionality (Where keywords typed in the address bar take you to the closest matching site.).<a href="#fn22" class="footnote-ref" id="fnref22"><sup>22</sup></a></li>
<li>The local DNS client built into modern operating systems will cache results of DNS searches for performance reasons. If a client switches between a home network and a <a href="Virtual_private_network" title="wikilink">VPN</a>, false entries may remain cached, thereby creating a service outage on the VPN connection.</li>
<li><a href="DNSBL" class="uri" title="wikilink">DNSBL</a> anti-spam solutions rely on DNS; false DNS results therefore interfere with their operation.</li>
<li>Confidential user data might be <a href="Internet_leak" title="wikilink">leaked</a> by applications that are tricked by the ISP into believing that the servers they wish to connect to are available.</li>
<li>User choice over which search engine to consult in the event of a URL being mistyped in a browser is removed as the ISP determines what search results are displayed to the user; functionality of applications like the <a href="Google_Toolbar" title="wikilink">Google Toolbar</a> do not work correctly.</li>
<li>Computers configured to use a <a href="Split_tunneling" title="wikilink">split tunnel</a> with a VPN connection will stop working because intranet names that should not be resolved outside the tunnel over the public Internet will start resolving to fictitious addresses, instead of resolving correctly over the VPN tunnel on a private DNS server when an NXDOMAIN response is received from the Internet. For example, a mail client attempting to resolve the DNS A record for an internal mail server may receive a false DNS response that directed it to a paid-results web server, with messages queued for delivery for days while retransmission was attempted in vain.<a href="#fn23" class="footnote-ref" id="fnref23"><sup>23</sup></a></li>
<li>It breaks <a href="Web_Proxy_Autodiscovery_Protocol" title="wikilink">Web Proxy Autodiscovery Protocol</a> (WPAD) by leading web browsers to believe incorrectly that the ISP has a <a href="proxy_server" title="wikilink">proxy server</a> configured.</li>
<li>It breaks monitoring software. For example, if we periodically contact a server to determine its health, a monitor will never see a failure unless the monitor tries to verify the server's cryptographic key.</li>
</ul>
<p>In some cases, the ISPs provide subscriber-configurable settings to disable hijacking of NXDOMAIN responses. Correctly implemented, such a setting reverts DNS to standard behavior. Other ISPs, however, instead use a web browser <a href="HTTP_cookie" title="wikilink">cookie</a> to store the preference. In this case, the underlying behavior is not resolved: DNS queries continue to be redirected, while the ISP redirect page is replaced with a counterfeit dns error page. Applications other than web-browsers cannot be opted out of the scheme using cookies as the opt-out targets only the <a href="HTTP" class="uri" title="wikilink">HTTP</a> protocol, when the scheme is actually implemented in the protocol-neutral DNS system.</p>
<h3 id="manipulation-by-registrars">Manipulation by Registrars</h3>
<p>Some Domain Name Registrars, notably Name.com,<a href="#fn24" class="footnote-ref" id="fnref24"><sup>24</sup></a> perform a DNS hijacking on failed domain name lookups despite objection to this practice by ICANN<a href="#fn25" class="footnote-ref" id="fnref25"><sup>25</sup></a> and their consumers.</p>
<h2 id="response">Response</h2>
<p>In the UK, the Information Commissioner's Office have acknowledged that the practice of involuntary DNS hijacking contravenes PECR, and EC Directive 95/46 on Data Protection which require explicit consent for processing of communication traffic. However they have refused to intervene, claiming that it would not be sensible to enforce the law, because it would not cause significant (or indeed any) demonstrable detriment to individuals.<a href="#fn26" class="footnote-ref" id="fnref26"><sup>26</sup></a><a href="#fn27" class="footnote-ref" id="fnref27"><sup>27</sup></a></p>
<p><a href="ICANN" class="uri" title="wikilink">ICANN</a>, the international body responsible for administering top-level domain names, has published a memorandum highlighting its concerns, and affirming:<a href="#fn28" class="footnote-ref" id="fnref28"><sup>28</sup></a> </p>
<h2 id="mitigation">Mitigation</h2>

<p>End users, dissatisfied with poor &quot;opt-out&quot; options like cookies, have responded to the controversy by finding ways to avoid spoofed NXDOMAIN responses. DNS software such as Bind and Dnsmasq offer options to filter results, and can be run from a gateway or router to protect an entire network. Google, among others, run open DNS servers that currently do not return spoofed results. So a user could use <a href="Google_Public_DNS" title="wikilink">Google Public DNS</a> instead of their ISP's DNS servers if they are willing to accept the associated loss of privacy associated with their online behavior being tracked. One limitation of this approach is that some providers block or rewrite outside DNS requests.</p>
<p>There are also application level work-arounds, such as the NoRedirect Firefox extension that mitigate some of the behavior. An approach like that only fixes one application (in this example, Firefox) and will not address any other issues caused. Website owners may be able to fool some hijackers by using certain DNS settings. For example, setting a TXT record of &quot;unused&quot; on their wildcard address (e.g. *.example.com). Alternatively, they can try setting the CNAME of the wildcard to &quot;example.invalid&quot;, making use of the fact that '.invalid' is guaranteed not to exist per the RFC. The limitation of that approach is that it only prevents hijacking on those particular domains, but it may address some VPN security issues caused by DNS hijacking.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Captive_portal" title="wikilink">Captive portal</a></li>
<li><a href="DNS_cache_poisoning" title="wikilink">DNS cache poisoning</a></li>
<li><a href="Domain_hijacking" title="wikilink">Domain hijacking</a></li>
<li><a href="Dynamic_Host_Configuration_Protocol" title="wikilink">Dynamic Host Configuration Protocol</a></li>
<li><a href="Pharming" class="uri" title="wikilink">Pharming</a></li>
<li><a href="Point-to-Point_Protocol" title="wikilink">Point-to-Point Protocol</a></li>
<li><a href="TCP_reset_attack" title="wikilink">TCP reset attack</a></li>
</ul>
<h2 id="references">References</h2>



<p><a href="Category:Domain_name_system" title="wikilink">Category:Domain name system</a> <a href="Category:Internet_fraud" title="wikilink">Category:Internet fraud</a> <a href="Category:Hacking_(computer_security)" title="wikilink">Category:Hacking (computer security)</a> <a href="Category:Internet_ethics" title="wikilink">Category:Internet ethics</a> <a href="Category:Internet_privacy" title="wikilink">Category:Internet privacy</a> <a href="Category:Internet_security" title="wikilink">Category:Internet security</a></p>
<section class="footnotes">
<hr />
<ol>
<li id="fn1"><a href="#fnref1" class="footnote-back">↩</a></li>
<li id="fn2"><a href="#fnref2" class="footnote-back">↩</a></li>
<li id="fn3"><a href="#fnref3" class="footnote-back">↩</a></li>
<li id="fn4"><a href="#fnref4" class="footnote-back">↩</a></li>
<li id="fn5"><a href="#fnref5" class="footnote-back">↩</a></li>
<li id="fn6"></li>
<li id="fn7"></li>
<li id="fn8"><a href="#fnref8" class="footnote-back">↩</a></li>
<li id="fn9"><a href="#fnref9" class="footnote-back">↩</a></li>
<li id="fn10"><a href="#fnref10" class="footnote-back">↩</a></li>
<li id="fn11"><a href="http://service1.dnsassist.optusnet.com.au/search?qh=DNS">Optus' &quot;About the Search Results Page&quot;</a><a href="#fnref11" class="footnote-back">↩</a></li>
<li id="fn12"><a href="#fnref12" class="footnote-back">↩</a></li>
<li id="fn13"><a href="http://www.iniqua.com/2010/05/10/nxdomain-redirect-xss/">XSS Reflected dnssearch.Ono.es NXD redirect &lt;U+00AB&gt; iniqua</a><a href="#fnref13" class="footnote-back">↩</a></li>
<li id="fn14"><a href="http://error.talktalk.co.uk/main?ParticipantID=nmum6rqpq5q6gkm3933n3nf9s76onu6r&amp;ClientLocation=uk&amp;FailureMode=14&amp;LinkID=Xyi3jH8AAAEAAG2pYhkAAABb&amp;PlatformInfo=&amp;LinkType=1&amp;Implementation=0">TalkTalk | About This Page</a><a href="#fnref14" class="footnote-back">↩</a></li>
<li id="fn15"><a href="http://www.crn.com.au/News/160923,bigpond-redirects-typos-to-unethical-branded-search-page.aspx">BigPond redirects typos to 'unethical' branded search page - CRN Australia</a><a href="#fnref15" class="footnote-back">↩</a></li>
<li id="fn16"><a href="#fnref16" class="footnote-back">↩</a></li>
<li id="fn17"><a href="#fnref17" class="footnote-back">↩</a></li>
<li id="fn18"><a href="#fnref18" class="footnote-back">↩</a></li>
<li id="fn19"><a href="#fnref19" class="footnote-back">↩</a></li>
<li id="fn20"><a href="#fnref20" class="footnote-back">↩</a></li>
<li id="fn21"></li>
<li id="fn22"><a href="#fnref22" class="footnote-back">↩</a></li>
<li id="fn23"><a href="#fnref23" class="footnote-back">↩</a></li>
<li id="fn24"><a href="#fnref24" class="footnote-back">↩</a></li>
<li id="fn25"><a href="#fnref25" class="footnote-back">↩</a></li>
<li id="fn26"><a href="#fnref26" class="footnote-back">↩</a></li>
<li id="fn27"><a href="#fnref27" class="footnote-back">↩</a></li>
<li id="fn28"></li>
</ol>
</section>
