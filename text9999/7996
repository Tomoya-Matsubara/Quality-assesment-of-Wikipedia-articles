{{chess notation}}
[[Image:Chess tablebase query.png|319px|thumb|A typical interface for querying a tablebase. For every White move, the tablebase gives the number of moves needed to win. Kc6 and Qa6+ win in five moves, so they are the optimal moves.]]
An '''endgame tablebase''' is a computerized [[database]] of all [[chess]] positions within certain [[endgame]]s.  The tablebase reveals the [[game theory|game-theoretical]] value of each position (win, loss, or [[draw (chess)|draw]]), and how many moves it will take to achieve that result with [[perfect play]].  Thus, the tablebase acts as an [[oracle machine|oracle]], always providing the optimal moves for both White and Black. 

Tablebases are generated by [[retrograde analysis]], working backwards from a [[checkmate]]d position. Tablebases have solved chess for every position with six pieces or fewer. The results of the solution have profoundly advanced the chess community's understanding of endgame theory.  Some positions which humans had analyzed as draws were proved to be decisive; the tablebase could see a mate in 100 moves or more, far beyond the [[horizon effect|horizon]] of both humans and computers. Tablebases have enhanced competitive play and facilitated the composition of [[endgame studies]]. They provide a powerful analytical tool, enabling students of chess to discover its deepest secrets.

==Background==
In principle, it is possible to [[solved game|solve any game]] under the condition that the complete state is known and there is no random chance.  Strong solutions are known for some simple games, such as [[Tic Tac Toe]] (draw with perfect play) and [[Connect Four]] (first player wins).  Other games, such as chess (from the starting position) and [[Go (game)|Go]], have not been solved because their [[game complexity]] is too vast for computers to evaluate all possible positions. To reduce the game complexity, researchers have modified these complex games by reducing the size of the board, or the number of pieces, or both.

[[Computer chess]] is one of the oldest domains of [[artificial intelligence]], having begun in the 1940s.  [[Claude Shannon]] proposed formal criteria for evaluating chess moves in 1949.  In 1951, [[Alan Turing]] designed a primitive chess playing program, which assigned values for material and mobility; the program "played" chess based on Turing's manual calculations {{harvcol|Levy|Newborn|1991|pp=25-38}}.  However, even as competent chess programs began to develop, they exhibited a glaring weakness in playing the endgame.  Programmers added specific [[heuristic]]s for the endgame <U+2013> for example, the [[king (chess)|king]] should move to the center of the board {{harvcol|Levy|Newborn|1991|pp=129-30}}.  However, a more comprehensive solution was needed.

In 1965, [[Richard Bellman]] proposed the creation of a database to solve chess and [[checkers]] endgames using [[retrograde analysis]] {{ref_harvard|Stiller1995|Stiller 1995:84|}}.<ref>{{cite journal | author=R. E. Bellman | title=On the application of dynamic programming to the determination of optimal play in chess and checkers | journal=Proceedings of the National Academy of Sciences of the United States of America | volume=53 | issue=2 | pages=244<U+2013>246 | month=February | year=1965}}</ref> Instead of analyzing ''forward'' from the position currently on the board, the database would analyze ''backward'' from positions where one player was [[checkmate]]d. Thus, a chess computer would no longer need to analyze endgame positions during the game because they were solved beforehand. It would no longer make mistakes because the tablebase always played the best possible move.

In 1970, Thomas Str<U+00F6>hlein published a doctoral thesis<ref>{{cite book | author=T. Str<U+00F6>hlein | title=Untersuchungen <U+00FC>ber kombinatorische Spiele [Translation: Investigations on Combinatorial Games] Ph.D. Thesis | publisher=Technical University of Munich | year=1970}}</ref><ref>See also {{cite journal | journal=EG | title=The 'End-Papers' | issue=52 | pages=25 | month=July | year=1978 | quote=Niblett and Kopec described, and later demonstrated, the optimal '''0103''' data base. (This work was in fact first done and published by Thomas Strohlein, Munich, in 1970, but only a single analytical line is contained in his doctoral thesis.) | url=http://www.gadycosteff.com/eg/eg52.pdf | format=PDF | accessdate=2007-04-01}}</ref> with analysis of the following classes of endgame: KQK, KRK, KPK, KQKR, KRKB, and KRKN (see [[Endgame#Endgame classification|Endgame classification]]).<ref>{{cite journal | author=T. Niblett | coauthors=A. J. Roycroft | title=How the GBR Class 0103 Data Base was Created. | journal=EG | issue=56 | pages145-46 | month=June | year=1979 | url=http://www.gadycosteff.com/eg/eg56.pdf | format=PDF | accessdate=2007-05-04}}</ref>  [[Ken Thompson (computer programmer)|Ken Thompson]] and others helped extend tablebases to cover all four- and five-piece endgames, including in particular KBBKN, KQPKQ, and KRPKR {{harvcol|Levy|Newborn|1991|p=144}}.<ref>See also: 
*{{cite journal | author=K. Thompson | title=Retrograde analysis of certain endgames | journal=ICCA Journal | year=1986}}
*{{cite journal | author=K. Thompson | title=The Programs that Generate Endgame Data Bases | journal=EG | issue=83 | pages=2 | month=May | year=1986 | url=http://www.gadycosteff.com/eg/eg83.pdf | format=PDF | accessdate=2007-05-04}} </ref>  Lewis Stiller published a thesis with research on some six-piece tablebase endgames in 1995 {{ref_harvard|Stiller1995|Stiller 1995:68-113|}}.<ref>See also: {{cite journal | author=L. B. Stiller | title=Some Results from a Massively Parallel Retrograde Analysis | journal=ICCA Journal | year=1991}}</ref>  

More recent contributors have included the following people:
*[[Eugene Nalimov]], after whom the popular Nalimov tablebases are named; 
*Eiko Bleicher, who has adapted the tablebase concept to a program called "Freezer" (see below);
*Guy Haworth, an academic at the [[University of Reading]], who has published extensively in the ''ICGA Journal'';
*Marc Bourzutschky and Yakov Konoval, who have collaborated to analyze endgames with seven pieces on the board.

The analysis of all endgames with up to six pieces (including the two kings) was completed in 2006. (However, tablebases with five pieces against a lone king have not been produced because the result is almost always obvious.) The tablebases for all positions with up to six pieces are available for free download, or can be queried on the web (see the external links below). Research on seven-piece tablebases is ongoing and may be completed by the end of 2015.<ref>{{cite web | author=J. Hurd | coauthors=G. McC. Haworth. | title=Chess Endgame Data Assurance. | url=http://www.cl.cam.ac.uk/~jeh1004/research/papers/ceda.pdf | format=PDF | accessdate=2007-04-01}}</ref>

== Generating tablebases ==
===Metrics: Depth to conversion and depth to mate===
{{Chess diagram|=
| tright
| 
|=
 8 |  |kd|  |  |  |  |  |  |=
 7 |  |  |  |  |  |  |  |  |=
 6 |  |kl|  |  |  |  |  |  |=
 5 |  |  |  |  |  |  |  |  |=
 4 |  |  |  |  |  |  |  |  |=
 3 |  |  |  |  |  |  |  |  |=
 2 |  |  |ql|  |  |  |  |  |=
 1 |  |  |  |rd|  |  |  |  |=
    a  b  c  d  e  f  g  h
| Example: DTC vs. DTM
}}
Before creating a tablebase, a programmer must choose a [[metric (mathematics)|metric]] of optimality <U+2013> in other words, he must define at what point a player has "won" the game.  Every position can be defined by its distance (i.e. the number of moves) from the desired endpoint.  Two metrics are generally used:
*'''Depth to mate''' (DTM). Checkmate is considered the only way to win.
*'''Depth to conversion''' (DTC). The stronger side can also win by capturing material, thus converting to a simpler endgame.  For example, in KQKR, conversion occurs when White captures the Black rook.
Haworth has discussed two other metrics, namely "depth to zeroing-move" (DTZ) and "depth by the rule" (DTR). These metrics correct for the [[fifty move rule]], but few tablebases with these metrics have been released to the public.<ref name="haworthoptimisation">{{cite journal | author=G. McC. Haworth | title=Strategies for Constrained Optimisation | journal=ICGA Journal | year=2000 | month=March | url=http://www.is.reading.ac.uk/common/publications/02124.pdf | format=PDF | accessdate=2007-04-01}}</ref>

The difference between DTC and DTM can be understood by analyzing the diagram at right.  How White should proceed depends on which metric is used.

{| class="wikitable"
|-
! Metric
! Play
! DTC
! DTM
|-
| DTC
| 1. Qxd1 Kc8 2. Qd2 Kb8 3. Qd8 mate 
| 1
| 3
|-
| DTM
| 1. Qc7+ Ka8 2. Qa7 mate
| 2
| 2
|}

According to the DTC metric, White should capture the rook because that "wins" immediately (DTC = 1), but it will take two more moves to checkmate (DTM = 3). In contrast according to the DTM metric, White mates in two moves, so DTM = DTC = 2.

This difference is typical of many endgames.  Usually DTC is smaller than DTM, but the DTM metric leads to the quickest checkmate.  Exceptions occur where the weaker side has only a king, and in the unusual endgame of [[Two knights endgame#Troitzky line|two knights versus one pawn]]; there DTC = DTM because either there is no defending material to capture or capturing the material does no good.  (Indeed, capturing the defending pawn in the latter endgame results in a draw.)

===Step 1: Generating all possible positions===
{{Chess diagram|=
| tright
| David Levy, ''How Computers Play Chess''
|=
 8 |  |  |  |  |  |  |  |  |=
 7 |  |  |  |  |  |  |  |  |=
 6 |  |  |  |  |  |  |  |  |=
 5 |  |  |  |  |  |  |  |  |=
 4 |  |  |  |xx|  |  |  |  |=
 3 |  |  |xx|xx|  |  |  |  |=
 2 |  |xx|xx|xx|  |  |  |  |=
 1 |xx|xx|xx|xx|  |  |  |  |=
    a  b  c  d  e  f  g  h
| The ten unique squares (with symmetry)
}}
Once a metric is chosen, the first step is to generate all the positions with a given material.  For example, to generate a DTM tablebase for the endgame of king and queen versus king (KQK), the computer must describe the 40,000 unique legal positions in an [[array]].  

Levy and Newborn explain that the number 40,000 derives from a [[symmetry]] argument.  The Black king can be placed on any of ten squares: a1, b1, c1, d1, b2, c2, d2, c3, d3, and d4 (see diagram).  On any other square, its position can be considered equivalent by symmetry of rotation or reflection.  Thus, there is no difference whether a Black king in a corner resides on a1, a8, h8, or h1.  Multiply this number of 10 by at most 64 squares for placing the White king and then by at most 64 squares for the White queen.  The product 10<U+00D7>64<U+00D7>64 = 40,960.  Several hundred of these positions are illegal, impossible, or symmetrical reflections of each other, so the actual number is somewhat smaller {{harvcol|Levy|Newborn|1991|pp=140-43}}.<ref>See also Stiller 1995:93-98.</ref>  

For each position, the tablebase evaluates the situation separately for White-to-move and Black-to-move.  Assuming that White has the queen, almost all the positions are White wins, with checkmate forced in not more than ten moves.  Some positions are draws because of [[stalemate]] or the unavoidable loss of the queen.

Each additional piece added to a [[Pawnless chess endgames|pawnless]] endgame multiplies the number of unique positions by about a factor of sixty <U+2013> the approximate number of squares not already occupied by other pieces.  

Endgames with one or more pawns increase the complexity because the symmetry argument is reduced.  Since pawns can move forward but not sideways, rotation and vertical reflection of the board produces a fundamental change in the nature of the position.  The best calculation of symmetry is achieved by limiting one pawn to 24 squares in the rectangle a2-a7-d7-d2.  All other pieces and pawns may be located in any of the 64 squares with respect to the pawn.  Thus, an endgame with pawns has a complexity of 24/10 = 2.4 times a pawnless endgame with the same number of pieces.

===Step 2: Evaluating positions using retrograde analysis===
[[Tim Krabb<U+00E9>]] explains the process of generating a tablebase as follows: 

<blockquote>"The idea is that a database is made with all possible positions with a given material [note: as in the preceding section]. Then a subdatabase is made of all positions where Black is mate. Then one where White can give mate. Then one where Black cannot stop White giving mate next move. Then one where White can always reach a position where Black cannot stop him from giving mate next move. And so on, always a ply further away from mate until all positions that are thus connected to mate have been found. Then all of these positions are linked back to mate by the shortest path through the database. That means that, apart from 'equi-optimal' moves, all the moves in such a path are perfect: White's move always leads to the quickest mate, Black's move always leads to the slowest mate."<ref name="stillermonsters">{{cite web | author=Tim Krabb<U+00E9>. | title="Stiller's Monsters or Perfection in Chess." | url=http://www.xs4all.nl/~timkr/chess/perfect.htm | accessdate=2007-04-01}}</ref></blockquote>

Figure 1 illustrates the idea of retrograde analysis. White mates in two moves with 1. Kc6, leading to the position in Figure 2. Then if 1...Kb8 2. Qb7 mate, and if 1...Kd8 2. Qd7 mate (Figure 3).

Figure 3, before White's second move, is defined as "mate in one [[ply (game theory)|ply]]." Figure 2, after White's first move, is "mate in two ply," regardless of how Black plays. Finally, the initial position in Figure 1 is "mate in three ply" (i.e., two moves) because it leads directly to Figure 2, which is already defined as "mate in two ply." This process, which links a current position to another position that could have existed one ply earlier, can continue indefinitely.  

Each position is evaluated as a win or loss in a certain number of moves. At the end of the retrograde analysis, positions which are not designated as wins or losses are necessarily draws.

{| style="float:left;display:inline;" |
|{{Chess diagram small|=
| tleft
| Figure 1
|=
 8 |  |  |kd|  |  |  |  |  |=
 7 |  |  |  |  |  |  |  |ql|=
 6 |  |  |  |  |  |  |  |  |=
 5 |  |  |  |kl|  |  |  |  |=
 4 |  |  |  |  |  |  |  |  |=
 3 |  |  |  |  |  |  |  |  |=
 2 |  |  |  |  |  |  |  |  |=
 1 |  |  |  |  |  |  |  |  |=
    a  b  c  d  e  f  g  h
| White to move: mate in three ply (Kc6)}}
|}
{| style="float:left;display:inline;" |
|{{Chess diagram small|=
| tleft
| Figure 2
|=
 8 |  |  |kd|  |  |  |  |  |=
 7 |  |  |  |  |  |  |  |ql|=
 6 |  |  |kl|  |  |  |  |  |=
 5 |  |  |  |  |  |  |  |  |=
 4 |  |  |  |  |  |  |  |  |=
 3 |  |  |  |  |  |  |  |  |=
 2 |  |  |  |  |  |  |  |  |=
 1 |  |  |  |  |  |  |  |  |=
    a  b  c  d  e  f  g  h
| Black to move: mate in two ply (Kd8 or Kb8)}}
|}
{| style="float:left;display:inline;" |
|{{Chess diagram small|=
| tleft
| Figure 3
|=
 8 |  |  |  |kd|  |  |  |  |=
 7 |  |  |  |  |  |  |  |ql|=
 6 |  |  |kl|  |  |  |  |  |=
 5 |  |  |  |  |  |  |  |  |=
 4 |  |  |  |  |  |  |  |  |=
 3 |  |  |  |  |  |  |  |  |=
 2 |  |  |  |  |  |  |  |  |=
 1 |  |  |  |  |  |  |  |  |=
    a  b  c  d  e  f  g  h
| White to move: mate in one ply (Qd7)}}
|}
{{-}}

===Step 3: Verification===

After the tablebase has been generated, and every position has been evaluated, the result must be verified independently.  The purpose is to check the [[self-consistency]] of the tablebase results.<ref name="Bourzutschky7man">{{cite web | author=M. Bourzutschky | title=7-man endgames with pawns | publisher=CCRL Discussion Board | date=2006-08-27 | url=http://kd.lab.nig.ac.jp/chess/discussion-board/viewtopic.php?t=805 | accessdate=2007-04-01}}</ref>

For example, in Figure 1 above, the verification program sees the evaluation "mate in three ply (Kc6)."  It then looks at the position in Figure 2, ''after'' Kc6, and sees the evaluation "mate in two ply."  These two evaluations are consistent with each other.  If the evaluation of Figure 2 were anything else, it would be inconsistent with Figure 1, so the tablebase would need to be corrected.

===Captures, pawn promotion, and special moves===

A four-piece tablebase must rely on three-piece tablebases that could result if one piece is captured. Similarly, a tablebase containing a pawn must be able to rely on other tablebases that deal with the new set of material after [[promotion (chess)|pawn promotion]] to a queen or other piece.  The retrograde analysis program must account for the possibility of a capture or pawn promotion on the previous move {{ref_harvard|Stiller1995|Stiller 1995:99-100|}}.  

Tablebases assume that [[castling]] is not possible for two reasons.  First, in practical endgames, this assumption is almost always correct.  (However, castling is allowed by convention in composed problems and studies.)  Second, if the king and rook are on their original squares, castling may or may not be allowed.  Because of this ambiguity, it would be necessary to make separate evaluations for states in which castling is or is not possible.

The same ambiguity exists for the ''[[en passant]]'' capture, since the possibility of ''en passant'' depends on the opponent's previous move.  However, practical applications of ''en passant'' occur frequently in pawn endgames, so tablebases account for the possibility of ''en passant'' for positions where both sides have at least one pawn.

===Using ''a priori'' information===
{{Chess diagram|=
| tright
| 
|=
 8 |  |  |  |  |  |  |  |kl|=
 7 |rl|  |  |  |bd|kd|  |  |=
 6 |  |  |  |  |  |  |  |  |=
 5 |  |  |  |  |  |  |  |  |=
 4 |  |  |  |  |  |  |  |  |=
 3 |pd|  |  |  |  |  |  |  |=
 2 |pl|  |  |  |  |  |  |  |=
 1 |  |  |  |  |  |  |  |  |=
    a  b  c  d  e  f  g  h
| An example of the KRP(a2)KBP(a3) endgame.  White mates in 72 moves, starting with 1.Kh7!  Other White moves draw.
}}
According to the method described above, the tablebase must allow the possibility that a given piece might occupy any of the 64 squares.  In some positions, it is possible to restrict the search space without affecting the result.  This saves computational resources and enables searches which would otherwise be impossible.  

An early analysis of this type was published in 1987, in the endgame KRP(a2)KBP(a3), where the Black bishop moves on the dark squares (see example position at right).<ref>{{cite journal | author=H. J. Herik | coauthors=I. S. Herschberg, N. Naka | title=A Six-Men-Endgame Database: KRP(a2)KbBP(a3) | journal=ICGA Journal | volume=10 | issue=4 | pages=163-180 | year=1987}}</ref>  In this position, we can make the following ''[[a priori]]'' assumptions:
:1. If a piece is captured, we can look up the resulting position in the corresponding tablebase with five pieces.  For example, if the Black pawn is captured, look up the newly created position in KRPKB.
:2. The White pawn stays on a2; capture moves are handled by the 1st rule.
:3. The Black pawn stays on a3; capture moves are handled by the 1st rule.<ref>{{cite web | author=E. Bleicher | title=Building Chess Endgame Databases for Positions with many Pieces using A-priori Information. | date=2004-08-26. | url=http://www.knowledge4it.de/download/FreezerAugust2004.pdf | format=PDF | accessdate=2007-04-01}}</ref>
The result of this simplification is that, instead of searching for 48 * 47 = 2,256 permutations for the pawns' locations, there is only one permutation.  Reducing the search space by a factor of 2,256 facilitates a much quicker calculation.

Bleicher has designed a commercial program called "Freezer," which allows users to build new tablebases from existing Nalimov tablebases with ''a priori'' information.  The program can produce a tablebase for seven-piece positions with blocked pawns, even though seven-piece tablebases are generally not available.<ref>{{cite web | author=K. M<U+00FC>ller | title=Freeze! | work=Endgame Corner | publisher=[[ChessCafe.com]] | month=May | year=2005 | url=http://www.chesscafe.com/text/mueller50.pdf | format=PDF | accessdate=2007-04-01}}</ref>

== Applications ==
=== Correspondence chess ===
{{Chess diagram|=
| tright
|Kasparov vs The World, 1999
|=
 |  |  |  |  |  |  |  |  |=
 |  |  |  |  |  |  |  |  |=
 |  |  |  |pd|  |kl|  |  |=
 |  |  |  |  |  |  |pl|  |=
 |  |ql|  |  |  |  |  |  |=
 |  |  |  |  |  |  |  |  |=
 |  |  |  |  |  |  |  |  |=
 |kd|  |  |qd|  |  |  |  |=
|The position after 55.Qxb4 when the game was reduced into a six piece position. A tablebase analysis now shows that the game is hopelessly lost for Black in 82 moves. However, it was not known at the time and the game continued for seven more moves for White before the World Team resigned.}}
In [[correspondence chess]], a player may consult a chess computer for assistance, provided that the etiquette of the competition allows this.  A six-piece tablebase (KQQKQQ) was used to analyze the endgame that occurred in the correspondence game [[Kasparov versus The World]].<ref>{{cite journal | author=E. V. Nalimov | coauthors=C. Wirth, G. McC. Haworth | title=KQQKQQ and the Kasparov<U+2013>World Game | journal=ICGA Journal | volume=22 | issue=4 | pages=195-212 | year=1999}}</ref>  Players have also used tablebases to analyze endgames from over-the-board play after the game is over.

Competitive players need to know that tablebases ignore the [[fifty-move rule]]. According to that rule, if fifty moves have passed without a capture or a pawn move, either player may claim a draw.  [[FIDE]] changed the rules several times, starting in 1974, to allow one hundred moves for endgames where fifty moves were insufficient to win. In 1988, FIDE allowed seventy-five moves for KBBKN, KNNKP, KQKBB, KQKNN, KRBKR, and KQPKQ with the pawn on the seventh rank, because tablebases had uncovered positions in these endgames requiring more than fifty moves to win. In 1992, FIDE canceled these exceptions and restored the fifty-move rule to its original standing.<ref name="haworthoptimisation"/> Thus a tablebase may identify a position as won or lost, when according to the fifty-move rule it is drawn.

Haworth has designed a tablebase that produces results consistent with the fifty-move rule. In general, however, tablebases do not accept this artificial restriction, and search for the theoretical limits of forced mate, even if it requires several hundred moves.

=== Computer chess ===

The knowledge contained in tablebases affords the computer a tremendous advantage in the endgame.  Not only can computers play perfectly within an endgame, but they can simplify to a winning tablebase position from a more complicated endgame.<ref>{{cite web   | url=http://www.chessbase.com/newsdetail.asp?newsid=3314 | author=Steven A. Lopez | date=2006-11-11 | title=Shredderbases | publisher=ChessBase.com | accessdate=2007-04-01}}</ref> For the latter purpose, some programs use "bitbases" which give the game-theoretical value of positions without the number of moves until conversion or mate <U+2014> that is, they only reveal whether the position is won, lost or draw. Sometimes even this data is compressed and the bitbase reveals only whether a position is won or not, making no difference between a lost and a draw game.<ref>{{cite web | url=http://horizonchess.com/FAQ/Winboard/egtb.html | title=A guide to Endgames Tablebase | author=Aaron Tay | accessdate=2007-08-09}}</ref>

However, some [[computer chess]] experts have observed practical drawbacks.<ref>{{cite web | author=A. Tay | url=http://horizonchess.com/FAQ/Winboard/weaktablebase.html | title=Can use of endgame tablebases weaken play? | date=2002-06-30 | accessdate=2007-04-01}}</ref> In addition to ignoring the fifty-move rule, a computer in a difficult position might avoid the losing side of a tablebase ending even if the opponent cannot practically win without himself knowing the tablebase. The adverse effect could be a premature resignation, or an inferior line of play that loses with less resistance than a tablebase might offer.

Another drawback is that tablebases require a lot of [[computer memory|memory]] to store the many thousands of positions.  The Nalimov tablebases, which use state-of-the-art compression techniques, require 7.05 [[Gigabyte|GB]] of hard disk space for all five-piece endings.  The six-piece endings require approximately 1.2 [[terabyte]]s.<ref>{{cite web   | url=http://chessdb.sourceforge.net/tutorial/t_tool_egtb.php | title=Endgame Tablebases | work=ChessDB Tutorial | author=David Kirkby | date=2007-03-12 | accessdate=2007-04-01}}</ref>  Nalimov seven-piece tablebases require more hard drive storage capacity and RAM to operate than will be practical to use for the foreseeable future. Bitbases, however, take much less space. Shredderbases, for example, used by the [[Shredder (chess)|Shredder]] program, compress all three, four and five piece bases into 157 [[megabyte|MB]]. This is a mere fraction of the 7.05 GB that the Nalimov tablebases require.<ref>{{cite web | url=http://www.shredderchess.com/chess-info/features/shredderbases.html | title=Shredder Computer Chess Download - Shredderbases | accessdate=2008-08-09}}</ref>

Some computers play better overall if their memory is devoted instead to the ordinary search and evaluation function.  Modern computers analyze far enough ahead conventionally to handle the elementary endgames without needing tablebases (i.e. without suffering from the [[horizon effect]]).  It is only for more sophisticated positions that the tablebase will improve significantly over the ordinary computer.

=== Endgame theory ===
{{main|Endgame#Effect of tablebases on endgame theory}}
Tablebases have answered longstanding questions about whether certain combinations of material are wins or draws.  The following interesting results have emerged:
* KBBKN &mdash; [[Bernhard Horwitz]] and [[Josef Kling]] (1851) proposed that Black can draw by entering a defensive [[fortress (chess)|fortress]], but tablebases demonstrated a general win, with maximum DTC = 66 or 67 and maximum DTM = 78.<ref>{{cite journal | author=A. J. Roycroft | title=Two Bishops Against Knight | journal=EG | issue=75 | pages=249 | year=1984 | url=http://www.gadycosteff.com/eg/eg75.pdf | accessdate=2007-05-04}}.</ref> (Also see [[pawnless chess endgames]].)
* KNNKP &mdash; [[Alexey Troitsky]] established this as a win for the knights if the pawn was blocked behind the [[two knights endgame#Troitzky line|Troitzky line]].  Analysis of the tablebases has clarified that even if the pawn has crossed the Troitzky line, White can sometimes win by forcing [[zugzwang]].<ref>{{cite journal | author=D. V. Hooper | title=GBR Class 0002.01 | journal=EG | issue=83 | pages=3 | year=1986 | url=http://www.gadycosteff.com/eg/eg75.pdf | accessdate=2007-05-04}}</ref>  Maximum DTC = DTM = 115 moves. 
* KNNNNKQ &mdash; The knights win in 62.5 percent of positions, with maximum DTM = 85 moves.<ref>{{cite web | url=http://www.xs4all.nl/~timkr/chess2/diary_15.htm | title=282. First 7-piece endgame database | date=2005-04-12 | accessdate=2007-03-25 | work=Open Chess Diary | author=Tim Krabb<U+00E9>}}</ref><ref>{{cite web | url=http://web.quick.cz/EVCOMP/tablebase.htm#7menfirst | title=News in 7 piece EGTB | date=2005-07-21 | accessdate=2007-03-25 | author=Emil Vlas<U+00E1>k}}</ref>
* KQRKQR &mdash; Despite the equality of material, the player to move wins in 67.74 percent of positions!<ref>{{cite web | author=G. McC. Haworth | title=Discarding Like Pieces | month=August | year=2001 | url=http://www.is.reading.ac.uk/common/publications/02128.pdf | format=PDF | accessdate=2007-04-01}}</ref> The maximum DTC = 92, and maximum DTM = 117.  In both this endgame and KQQKQQ, the first player to [[check (chess)|''check'']] usually wins {{harvcol|Nunn|2002|pp=379, 384}}.

{{Chess diagram|=
| tright
| Lewis Stiller, 1991
|=
 8 |  |  |  |  |  |  |nl|  |=
 7 |  |  |  |  |  |kl|rl|  |=
 6 |  |  |nd|  |  |  |  |  |=
 5 |  |  |  |  |  |  |  |  |=
 4 |  |  |  |  |  |  |  |  |=
 3 |  |  |  |  |  |  |  |  |=
 2 |  |  |nd|  |  |  |  |  |=
 1 |  |kd|  |  |  |  |  |  |=
    a  b  c  d  e  f  g  h
| White mates in 262 moves
}}
*KRNKNN and KRBKNN &mdash; [[Friedrich Amelung]] had analyzed these two endgames in the 1900s {{ref_harvard|Stiller1995|Stiller 1995:81|}}.  KRNKNN and KRBKNN are won for the strongest side in 78 percent<ref>{{cite web | author=Tim Krabb<U+00E9> | work=Open Chess Diary | url=http://www.xs4all.nl/~timkr/chess2/diary_3.htm | title=60. Play chess with God | accessdate=2007-05-13 | date=2000-04-08}}.</ref> and 95 percent<ref name="stillermonsters">{{cite web | author=Tim Krabb<U+00E9>. | title="Stiller's Monsters or Perfection in Chess." | url=http://www.xs4all.nl/~timkr/chess/perfect.htm | accessdate=2007-04-01}}</ref> of the cases, respectively. Stiller's DTC tablebase revealed several lengthy wins in these endgames.  The longest win in KRBKNN has DTC = 223 and DTM = 238 moves (not shown).  Even more amazing is the position at right, where White wins starting with 1. Ke6!  Stiller reported the DTC as 243 moves, and the DTM was later found to be 262 moves {{ref_harvard|Stiller1995|Stiller 1995:102-8|}}. 

For some years, this position held the record for the longest computer-generated forced mate.  ([[Otto Blathy]] had composed a "mate in 292 moves" problem already in 1889.)<ref>{{cite web | url=http://www.geocities.com/bioelectrochemistry/blathy.html | title=Blathy | accessdate=2007-05-04 | date=2003-06-21}}</ref><ref>{{cite web | url=http://www.chess-problem.com/classic4.htm | title=Udo's problem pages: Mate in 292 | author=Udo Marks | accessdate=2007-05-04}}</ref> However, in May 2006, Bourzutschky and Konoval discovered a KQNKRBN position with an astonishing DTC of 517 moves.  This was more than twice as long as Stiller's maximum, and almost 200 moves beyond the previous record of DTC = 330 for a position of KQBNKQB_1001.  Bourzutschky wrote, "This was a big surprise for us and is a great tribute to the complexity of chess."<ref>{{cite web | author=Tim Krabb<U+00E9> | work=Open Chess Diary | url=http://www.xs4all.nl/~timkr/chess2/diary_16.htm | title=311. White plays and wins in 330 moves | accessdate=2007-05-04 | date=2006-03-31}}.</ref><ref>{{cite web | author=Tim Krabb<U+00E9> | work=Open Chess Diary | url=http://www.xs4all.nl/~timkr/chess2/diary_16.htm | title=316. A 517-move win | accessdate=2007-05-04 | date=2006-05-26}}.</ref>

In August 2006, Bourzutschky released preliminary results from his analysis of the following seven-piece endgames: KQQPKQQ, KRRPKRR, and KBBPKNN.<ref name="Bourzutschky7man"/>

===Endgame studies===
{{Chess diagram|=
| tright
| E. Pogosyants, ''EG'' 1978
|=
 8 |  |  |  |  |  |  |  |  |=
 7 |  |  |  |  |  |  |  |  |=
 6 |  |  |  |  |  |  |  |rd|=
 5 |  |  |  |nl|  |  |  |  |=
 4 |  |  |  |  |  |  |  |  |=
 3 |  |  |  |  |  |  |  |  |=
 2 |  |  |  |  |  |  |  |pl|=
 1 |rl|  |  |  |kl|  |  |kd|=
    a  b  c  d  e  f  g  h
| White to play and win.  The composer intended 1. Ne3 as a solution, but a tablebase revealed that 1. h4 also wins.
}}
{{Chess diagram|=
| tright
| Harold van der Heijden, 2001
|=
 8 |  |  |  |  |  |  |  |  |=
 7 |  |  |  |  |  |  |  |pl|=
 6 |  |  |  |  |  |  |  |  |=
 5 |  |  |  |  |  |  |  |  |=
 4 |kl|  |  |  |  |  |  |  |=
 3 |pl|  |  |  |  |  |  |  |=
 2 |  |  |  |  |  |  |kd|rd|=
 1 |  |  |  |  |  |  |  |  |=
    a  b  c  d  e  f  g  h
| White to play and draw
}}
Since many composed [[endgame studies]] deal with positions that exist in tablebases, their soundness can be checked using the tablebases.  Some studies have been cooked, i.e. proved unsound, by the tablebases.  That can be either because the composer's solution does not work, or else because there is an equally effective alternative that the composer did not consider.  Another way tablebases cook studies is a change in the evaluation of an endgame.  For instance, the endgame with a queen and bishop versus two rooks was thought to be a draw, but tablebases proved it to be a win for the queen and bishop, so almost all studies based on this endgame are unsound {{harvcol|Nunn|2002|p=367-68}}.

For example, Erik Pogosyants composed the study at right, with White to play and win. His intended main line was 1. Ne3 Rxh2 2. O-O-O mate! A tablebase discovered that 1. h4 also wins for White, even though Black can capture the pawn. Ironically, the tablebase does not recognize the composer's solution because it includes castling.<ref>{{cite web | author=Tim Krabb<U+00E9> | work=Open chess diary | title=324. A cooked, correct study | date=2006-09-15 | url=http://www.xs4all.nl/~timkr/chess2/diarytxt.htm | accessdate=2007-05-04}}</ref> 

While tablebases have cooked some studies, they have assisted in the creation of other studies.  Composers can search tablebases for interesting positions, such as [[zugzwang]], using a method called [[Data mining#Combinatorial game data mining|data mining]].  For all three- to five-piece endgames and pawnless six-piece endgames, a complete list of mutual zugzwangs has been tabulated and published.<ref>{{cite journal | author=G. McC. Haworth | title=3<U+2013>5 Man Mutual Zugzwangs in Chess | journal=Proceedings of the CMG 6th Computer Olympiad Computer-Games Workshop | coauthors=Editor: J.W.H.M. Uiterwijk | volume=TR CS 01-04 | year=2001}}</ref><ref>{{cite journal | author=G. McC. Haworth | title=Ken Thompson's 6-man Tables | journal=ICGA Journal | year=2001}}</ref><ref>{{cite journal | author=G. McC. Haworth | coauthors=P. Karrer, J. A. Tamplin, and C. Wirth | title=3<U+2013>5 Man Chess: Maximals and Mzugs | journal=ICGA Journal | volume=24 | issue=4 | pages=225<U+2013>30 | year=2001}}</ref>

There has been some controversy whether to allow endgame studies composed with tablebase assistance into composing tourneys. In 2003, the endgame composer and expert [[John Roycroft]] summarized the debate:

<blockquote>"[N]ot only do opinions diverge widely, but they are frequently adhered to strongly, even vehemently: at one extreme is the view that since we can never be certain that a computer has been used it is pointless to attempt a distinction, so we should simply evaluate a 'study' on its content, without reference to its origins; at the other extreme is the view that using  a 'mouse' to lift an interesting position from a ready-made computer-generated list is in no sense composing, so we should outlaw every such position."<ref name="EG194editorial">{{cite journal | author=A. J. Roycroft | title=Editorial | journal=EG | issue=149 | pages=51 | month=July | year=2003 | url=http://www.gadycosteff.com/eg/eg149.pdf | accessdate=2007-05-04}}</ref></blockquote>

Roycroft himself agrees with the latter approach.  He continues, "One thing alone is clear to us: the distinction between classical composing and computer composing should be preserved for as long as possible: if there is a name associated with a study diagram that name is a claim of authorship."<ref name="EG194editorial"/>

[[Mark Dvoretsky]], a chess master and instructor, took a more permissive stance.  He was commenting in 2006 on a study by [[Harold van der Heijden]], published in 2001, which reached the position at right after three introductory moves.  The drawing move for White is 4. Kb4!! (and not 4. Kb5), based on a mutual zugzwang that may occur three moves later.  

Dvoretsky comments <blockquote>"Here, we should touch on one delicate question. I am sure that this unique endgame position was discovered with the help of Thompson<U+2019>s famous computer database. Is this a 'flaw,' diminishing the composer's achievement?
<br>
<br>
"Yes, the computer database is an instrument, available to anyone nowadays. Out
of it, no doubt, we could probably extract yet more unique positions <U+2013> there are
some chess composers who do so regularly. The standard for evaluation here
should be the result achieved. Thus: miracles, based upon complex computer
analysis rather than on their content of sharp ideas, are probably of interest only
to certain aesthetes."<ref>{{cite web | author=M. Dvoretsky | title=Study Composing Tourney | work=The Instructor | publisher=ChessCafe.com | month=July | year=2006 | url=http://www.chesscafe.com/text/dvoretsky70.pdf | format=PDF | accessdate=2007-04-01}}</ref></blockquote>

=="Play chess with God"==

On the [[Bell Labs]] website, Ken Thompson maintains a link to some of his tablebase data.  The headline reads, "Play chess with God."<ref>{{cite web | url=http://plan9.bell-labs.com/who/ken/ | author=Ken Thompson | title=Play chess with God | date=2002-08-21 | accessdate=2007-03-25}}</ref>

Regarding Stiller's long wins, Tim Krabb<U+00E9> struck a similar note: <blockquote> "A grandmaster wouldn't be better at these endgames than someone who had learned chess yesterday. It's a sort of chess that has nothing to do with chess, a chess that we could never have imagined without computers. The Stiller moves are awesome, almost scary, because you know they are the truth, God's Algorithm <U+2013> it's like being revealed the Meaning of Life, but you don't understand one word."<ref name="stillermonsters"/>
</blockquote>

==[[Nomenclature]]==

Originally, an endgame tablebase was called an "endgame data base" or "endgame database".  This name appeared in both ''[[EG (chess)|EG]]'' and the ''[[ICCA Journal]]'' starting in the 1970s, and is sometimes used today.  According to Haworth, the ''ICCA Journal'' first used the word "tablebase" in connection with chess endgames in 1995.<ref>{{cite journal | journal=EG | issue=137 | page=151 | year=1995 | url=http://www.gadycosteff.com/eg/eg137.pdf | title=Tablebases and Tables | author=Guy Haworth | accessdate=2007-05-04}}</ref>  According to that source, a tablebase contains a complete set of information, but a database might lack some information.

Haworth prefers the term "Endgame Table", and has used it in the articles<ref>{{cite web | url=http://www.is.reading.ac.uk/people/G.Haworth.htm?publications | publisher=The University of Reading | work=Information Systems at Reading | title=Publications for Mr Guy Haworth | accessdate=2007-05-04}}</ref> he has authored.  Roycroft has used the term "oracle database" throughout his magazine, ''EG''.<ref>For example, in {{cite journal | journal=EG | issue=135 | pages=9 | url=http://www.gadycosteff.com/eg/eg135.pdf | title=Proposal For The Guidance Of Tourney Organisers, Composers And Judges: 0. Definitions | format=PDF | quote=''odb'' <U+2014> otherwise known as total information database or tablebase. | accessdate=2007-04-01}}</ref> Nonetheless, the mainstream chess community has adopted "endgame tablebase" as the most common name.

==See also==
* [[Endgame]]
* [[Computer chess]]
* [[EG (magazine)]]
* [[ICGA Journal]]

==Notes==
{{reflist}}

== References==
*{{Citation
|surname1=Levy|given1=David|authorlink1=David Levy (chess player)
|surname2=Newborn|given2=Monty
|year=1991
|title=How Computers Play Chess
|publisher=Computer Science Press
|ID=ISBN 0-7167-8121-2
}}
*{{Citation
|last=Nunn|first=John|author-link=John Nunn
|year=2002
|title=Secrets of Pawnless Endings
|publisher=Gambit Publications
|ID=ISBN 1-901983-65-X
}}
* {{note_label|Stiller1995|Stiller 1995|}} {{cite book
 | author = Lewis Benjamin Stiller
 | year = 1995
 | title = Exploiting symmetry on parallel architectures 
 | publisher = Ph.D. Thesis, Johns Hopkins University
 | url = http://users.rcn.com/lstiller/thesis.pdf 
 | format = PDF
 | accessdate=2007-05-04
}}

== External links ==
* [http://horizonchess.com/FAQ/Winboard/egtb.html Guide to the use of Computer Chess Endgame Tablebases by Aaron Tay]
* Downloading tablebases
** [http://kd.lab.nig.ac.jp/chess/tablebases-online/ Distribution site for tablebases up to six pieces]
** [ftp://ftp.cis.uab.edu/pub/hyatt/TB/3-4-5 3-4-5 pieces] on [[Robert Hyatt|Robert Hyatt's]] FTP site
* Querying tablebases on the web
** [http://www.k4it.de/index.php?topic=egtb&lang=en Web query server for Nalimov tablebases by Eiko Bleicher] (up to six pieces)
** [http://www.lokasoft.nl/uk/tbweb.htm Web query server for Nalimov tablebases by Lokasoft] (up to five pieces)
* [http://kd.lab.nig.ac.jp/chess/longest-checkmates/longest-checkmates.shtml Maximal positions], i.e. longest DTM positions for endgames with up to five pieces and some with six pieces, compiled by Kirill Kryukov

[[Category:Chess endgames|*]]
[[Category:Chess terms]]
[[Category:Computer chess]]
[[Category:Databases]]

[[de:Endspiel-Datenbank (Schach)]]
[[ru:<U+042D><U+043D><U+0434><U+0448><U+043F><U+0438><U+043B><U+044C><U+043D><U+044B><U+0435> <U+0442><U+0430><U+0431><U+043B><U+0438><U+0446><U+044B> <U+041D><U+0430><U+043B><U+0438><U+043C><U+043E><U+0432><U+0430>]]
